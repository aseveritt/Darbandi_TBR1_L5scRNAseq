p2b <- VlnPlot(experiment.aggregate, "nGene", do.return = TRUE) + geom_hline(yintercept = 3000, color= "red")
p2b <- p2b + ggtitle("Distribution of nGene by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p3a <- ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - all cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0,0.25, 0.3, 0.50, 0.75,1)) + theme(axis.text.x = element_text(color=c(rep("black",2),"red",rep("black",3))))
p3b <- VlnPlot(experiment.aggregate, "percent.mito", do.return = TRUE) + geom_hline(yintercept = 0.3, color= "red")
p3b <- p3b + ggtitle("Distribution of mito % by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
#grid.arrange(p1a,p2a, p3a, p1b, p2b, p3b, ncol=3)
#Full tSNE plot
load("../scripts/outputs/output_02/experiment_aggregate.0.3.RData")
#By Genotype
experiment.aggregate.0.3@meta.data$Figure <- gsub("L5|/", "", experiment.aggregate.0.3@meta.data$orig.ident)
experiment.aggregate.0.3@meta.data[experiment.aggregate.0.3@meta.data$Figure == "NULL",]$Figure <- "NULL                   "
experiment.aggregate.0.3@meta.data$Figure <- factor(experiment.aggregate.0.3@meta.data$Figure, levels = c("WT", "HET", "NULL                   "))
byGeno <- TSNEPlot(object = experiment.aggregate.0.3, group.by="Figure", pt.size=0.1, do.label = F, do.return=T, colors.use = c("red", "green", "blue"), plot.order=c("HET","NULL                   ","WT"))
#By Cell type
current.cluster.ids <- c(0:11)
new.cluster.ids <- c("Neuronal", "Neuronal", "Neuronal","Microglia","Astrocyte",
"Interneuron","Interneuron","Endothelial","Interneuron",
"Oligodendrocytes","Pericyte","Pericyte")
experiment.aggregate.0.3@ident <- plyr::mapvalues(x = experiment.aggregate.0.3@ident,
from = current.cluster.ids, to = new.cluster.ids)
byCellType <- TSNEPlot(object = experiment.aggregate.0.3, pt.size = 0.5, do.return=T, do.label = F,
colors.use = c("#F8766D","#C49A00", "#53B400", "#00C094", "#00B6EB", "#A58AFF", "#FB61D7"))
#byCellType <- TSNEPlot(object = experiment.aggregate.0.3, pt.size = 0.1, do.return=T,
#                      colors.use = c("#A58AFF", "#FCC7C3","#E7D597", "#B9E197", "#97E5D3", "#97E1F7", "#FDBEEE"))
load("../scripts/outputs/output_02/experiment_aggregate.0.3.RData")
neuronal_cells <- rownames(experiment.aggregate.0.3@meta.data[experiment.aggregate.0.3@meta.data$res.0.3 %in% c(0,1,2),])
experiment.aggregate <- SubsetData(experiment.aggregate.0.3, cells.use = neuronal_cells, do.clean = T)
ggplot(experiment.aggregate@meta.data, aes(x=nUMI)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nUMI - neuronal cells") +
geom_vline(aes(xintercept=4000),color="red") + geom_vline(aes(xintercept=500),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 2000, 4000, 6000, 8000)) + theme(axis.text.x = element_text(color=c("red","black", "red", rep("black",2))))
ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- neuronal cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=1700),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 1000, 1700, 2000)) + theme(axis.text.x = element_text(color=c("red","black", "red", "black")))
ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - neuronal cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0, 0.1, 0.2, 0.3)) + theme(axis.text.x = element_text(color=c(rep("black",3), "red")))
p4a <- ggplot(experiment.aggregate@meta.data, aes(x=nUMI)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nUMI - neuronal cells") +
geom_vline(aes(xintercept=4000),color="red") + geom_vline(aes(xintercept=500),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 2000, 4000, 6000, 8000)) + theme(axis.text.x = element_text(color=c("red","black", "red", rep("black",2))))
p4b <- VlnPlot(experiment.aggregate, "nUMI", do.return = TRUE, group.by = "orig.ident") +
geom_hline(yintercept = 4000, color= "red")
p4b <- p4b + ggtitle("Distribution of nUMI by genotype") + xlab("Genotype") + ylab("count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p5a <- ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- neuronal cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=1700),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 1000, 1700, 2000)) + theme(axis.text.x = element_text(color=c("red","black", "red", "black")))
p5b <- VlnPlot(experiment.aggregate, "nGene", do.return = TRUE, group.by = "orig.ident") +
geom_hline(yintercept = 1700, color= "red")
p5b <- p5b + ggtitle("Distribution of nGene by genotype") + xlab("Genotype") + ylab("count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p6a <- ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - neuronal cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0, 0.1, 0.2, 0.3)) + theme(axis.text.x = element_text(color=c(rep("black",3), "red")))
p6b <- VlnPlot(experiment.aggregate, "percent.mito", do.return = TRUE, group.by = "orig.ident") +
geom_hline(yintercept = 0.299, color= "red")
p6b <- p6b + ggtitle("Distribution of mito % by genotype") + xlab("Genotype") + ylab("count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
#Neuronal tSNE plot
load("../scripts/outputs/output_03/neuronal_object.RData")
experiment.aggregate@meta.data$Figure <- experiment.aggregate@meta.data$orig.ident
experiment.aggregate@meta.data[experiment.aggregate@meta.data$Figure == "NULL",]$Figure <- "NULL                   "
experiment.aggregate@meta.data[experiment.aggregate@meta.data$res.0.3 %in% c(4,5),]$Figure <- "Atypical"
experiment.aggregate@meta.data$Figure <- factor(experiment.aggregate@meta.data$Figure,
levels = c("WT", "HET", "NULL                   ", "Atypical"))
neuronal_tsne <- TSNEPlot(object = experiment.aggregate, group.by="Figure", pt.size=0.5, colors.use = c("red","green","blue","grey"), do.return=T)
#neuronal_tsne <- neuronal_tsne + theme(legend.position = "top")
setwd("/Users/AEveritt/projects/scRNAseq_L5_Tbr1/scRNAseq_L5_Tbr1_Rpackage/publication_images/")
library("Seurat")
dataset_loc <- "../raw_data/mm10"
ids <- c("L5HET/", "L5NULL/","L5WT/", "pilot/L5_NULL_Run1/",  "pilot/L5_WT_Run1/")
d10x.data <- sapply(ids, function(i){
print(i)
d10x <- Read10X(file.path(dataset_loc,i))
colnames(d10x) <- paste(sapply(strsplit(colnames(d10x),split="-"),'[[',1L),i,sep="-")
d10x
})
experiment.data <- do.call("cbind", d10x.data)
experiment.aggregate <- CreateSeuratObject(
experiment.data,
project = "Sivash scRNA",
names.field = 2,
min.cells = 17,
names.delim = "\\-")
experiment.aggregate
mito.genes <- grep("^mt-", rownames(experiment.aggregate@data), value = T)
percent.mito <- Matrix::colSums(experiment.aggregate@raw.data[mito.genes, ]) / Matrix::colSums(experiment.aggregate@raw.data)
experiment.aggregate <- AddMetaData(
object = experiment.aggregate,
metadata = percent.mito,
col.name= "percent.mito")
experiment.aggregate@meta.data$orig.ident <- gsub("_Run1","_Pilot", gsub("L5|/|pilot/|L5_", "", experiment.aggregate@meta.data$orig.ident))
experiment.aggregate@meta.data$orig.ident <- factor(experiment.aggregate@meta.data$orig.ident, levels=c("WT","HET","NULL","WT_Pilot","NULL_Pilot") )
mito.data <- VlnPlot(experiment.aggregate, "percent.mito", group.by = "orig.ident", do.return = TRUE, y.max=0.5)
ggplot(mito.data$data, aes(x=ident, y=feature, fill=ident)) +
geom_jitter(alpha = 0.5) +
geom_boxplot(alpha = 0.8) + scale_fill_manual(values=c("red","green","blue","#FF5C5C","#5C5CFF")) +
ylim(c(0,0.5)) +
ggtitle("Mitochondrial Fraction in pilot and manuscript datasets") +
ylab("Fraction of mitochondrial genes in cell") + xlab("") +
theme_bw() + theme(legend.position = "none") +
geom_hline(yintercept = 0.3, color= "red") +
scale_y_continuous(breaks=c(0,0.1, 0.2,0.3,0.4, 0.5)) + theme(axis.text.x = element_text(color=c(rep("black",3),"red","black","black")))
ggplot(mito.data$data, aes(x=ident, y=feature, fill=ident)) +
geom_jitter(alpha = 0.5) +
geom_boxplot(alpha = 0.8) + scale_fill_manual(values=c("red","green","blue","#FF5C5C","#5C5CFF")) +
ylim(c(0,0.5)) +
ggtitle("Mitochondrial Fraction in pilot and manuscript datasets") +
ylab("Fraction of mitochondrial genes in cell") + xlab("") +
theme_bw() + theme(legend.position = "none") +
geom_hline(yintercept = 0.3, color= "red") +
scale_y_discrete(breaks=c(0,0.1, 0.2,0.3,0.4, 0.5)) + theme(axis.text.x = element_text(color=c(rep("black",3),"red","black","black")))
ggplot(mito.data$data, aes(x=ident, y=feature, fill=ident)) +
geom_jitter(alpha = 0.5) +
geom_boxplot(alpha = 0.8) + scale_fill_manual(values=c("red","green","blue","#FF5C5C","#5C5CFF")) +
#ylim(c(0,0.5)) +
ggtitle("Mitochondrial Fraction in pilot and manuscript datasets") +
ylab("Fraction of mitochondrial genes in cell") + xlab("") +
theme_bw() + theme(legend.position = "none") +
geom_hline(yintercept = 0.3, color= "red") +
scale_y_continuous(breaks=c(0,0.1, 0.2,0.3,0.4, 0.5), limits = c(0,0.5)) + theme(axis.text.x = element_text(color=c(rep("black",3),"red","black","black")))
ggplot(mito.data$data, aes(x=ident, y=feature, fill=ident)) +
geom_jitter(alpha = 0.5) +
geom_boxplot(alpha = 0.8) + scale_fill_manual(values=c("red","green","blue","#FF5C5C","#5C5CFF")) +
ggtitle("Mitochondrial Fraction in pilot and manuscript datasets") +
ylab("Fraction of mitochondrial genes in cell") + xlab("") +
theme_bw() + theme(legend.position = "none") +
geom_hline(yintercept = 0.3, color= "red") +
scale_y_continuous(breaks=c(0,0.1, 0.2,0.3,0.4, 0.5), limits = c(0,0.5)) +
theme(axis.text.y = element_text(color=c(rep("black",3),"red","black","black")))
mito.plot <- ggplot(mito.data$data, aes(x=ident, y=feature, fill=ident)) +
geom_jitter(alpha = 0.5) +
geom_boxplot(alpha = 0.8) + scale_fill_manual(values=c("red","green","blue","#FF5C5C","#5C5CFF")) +
ggtitle("Mitochondrial Fraction in pilot and manuscript datasets") +
ylab("Fraction of mitochondrial genes in cell") + xlab("") +
theme_bw() + theme(legend.position = "none") +
geom_hline(yintercept = 0.3, color= "red") +
scale_y_continuous(breaks=c(0,0.1, 0.2,0.3,0.4, 0.5), limits = c(0,0.5)) +
theme(axis.text.y = element_text(color=c(rep("black",3),"red","black","black")))
library(grid)
p1a <- p1a + ylim(c(0,1500)) + ylab("Frequency of Counts") + theme(axis.text.x =  element_text(size=5)) + ggtitle("")
p2a <- p2a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
p3a <- p3a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) + xlab("fraction mt-")
p4a <- p4a + ylim(c(0,1500)) + ylab("Frequency of Counts") + ggtitle("")
p5a <- p5a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
p6a <- p6a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) + xlab("fraction mt-")
blank <- grid.rect(gp=gpar(col="white"))
byCellType <- byCellType + ggtitle(" ")
byGeno <- byGeno + ggtitle(" ")
neuronal_tsne <- neuronal_tsne + ggtitle(" ")
mito.plot <- mito.plot + ggtitle(" ") + ylab("Fraction of mt- genes in cell") #+ theme(axis.title.y = element_text(size=9))
setwd("/Users/AEveritt/projects/scRNAseq_L5_Tbr1/scRNAseq_L5_Tbr1_Rpackage/publication_images/")
pdf(file="QCMetrics.pdf", width = 13, height = 9)
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and filtering cut-offs for all cells",
"D) tSNE all cells by cell type"),
label_x = c(-0.20,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) tSNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and filtering cut-offs for neuronal cells",
"F) tNSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
dev.off()
ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - neuronal cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0, 0.1, 0.2, 0.3)) + theme(axis.text.x = element_text(color=c(rep("black",3), "red")))
p6a
#PART 1 QC plots
load("unfiltered_expr_aggregate.Rdata")
p1a <- ggplot(experiment.aggregate@meta.data, aes(x=nUMI)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nUMI- all cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=10000),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 10000, 20000,30000,40000, 50000)) + theme(axis.text.x = element_text(color=c("red","red",rep("black",4))))
p1b <- VlnPlot(experiment.aggregate, "nUMI", do.return = TRUE) + geom_hline(yintercept = 10000, color= "red")
p1b <- p1b + ggtitle("Distribution of nUMI by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p2a <- ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- all cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=3000),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500,2000,3000,4000,6000)) + theme(axis.text.x = element_text(color=c("red","black","red",rep("black",3))))
p2b <- VlnPlot(experiment.aggregate, "nGene", do.return = TRUE) + geom_hline(yintercept = 3000, color= "red")
p2b <- p2b + ggtitle("Distribution of nGene by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p3a <- ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - all cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0, 0.3, 0.50, 0.75,1)) + theme(axis.text.x = element_text(color=c("black","red",rep("black",3))))
p3b <- VlnPlot(experiment.aggregate, "percent.mito", do.return = TRUE) + geom_hline(yintercept = 0.3, color= "red")
p3b <- p3b + ggtitle("Distribution of mito % by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
#grid.arrange(p1a,p2a, p3a, p1b, p2b, p3b, ncol=3)
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and filtering cut-offs for all cells",
"D) tSNE all cells by cell type"),
label_x = c(-0.20,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) tSNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and filtering cut-offs for neuronal cells",
"F) tNSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
#PART 2 QC plots
load("../scripts/outputs/output_02/experiment_aggregate.0.3.RData")
neuronal_cells <- rownames(experiment.aggregate.0.3@meta.data[experiment.aggregate.0.3@meta.data$res.0.3 %in% c(0,1,2),])
experiment.aggregate <- SubsetData(experiment.aggregate.0.3, cells.use = neuronal_cells, do.clean = T)
#PART 2 QC plots
load("../scripts/outputs/output_02/experiment_aggregate.0.3.RData")
neuronal_cells <- rownames(experiment.aggregate.0.3@meta.data[experiment.aggregate.0.3@meta.data$res.0.3 %in% c(0,1,2),])
experiment.aggregate <- SubsetData(experiment.aggregate.0.3, cells.use = neuronal_cells, do.clean = T)
p4a <- ggplot(experiment.aggregate@meta.data, aes(x=nUMI)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nUMI - neuronal cells") +
geom_vline(aes(xintercept=4000),color="red") + geom_vline(aes(xintercept=500),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 2000, 4000, 6000, 8000)) + theme(axis.text.x = element_text(color=c("red","black", "red", rep("black",2))))
p4b <- VlnPlot(experiment.aggregate, "nUMI", do.return = TRUE, group.by = "orig.ident") +
geom_hline(yintercept = 4000, color= "red")
p4b <- p4b + ggtitle("Distribution of nUMI by genotype") + xlab("Genotype") + ylab("count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p5a <- ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- neuronal cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=1700),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 1000, 1700, 3000)) + theme(axis.text.x = element_text(color=c("red","black", "red", "black")))
p5b <- VlnPlot(experiment.aggregate, "nGene", do.return = TRUE, group.by = "orig.ident") +
geom_hline(yintercept = 1700, color= "red")
p5b <- p5b + ggtitle("Distribution of nGene by genotype") + xlab("Genotype") + ylab("count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p6a <- ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - neuronal cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0, 0.1, 0.2, 0.3)) + theme(axis.text.x = element_text(color=c(rep("black",3), "red")))
p6b <- VlnPlot(experiment.aggregate, "percent.mito", do.return = TRUE, group.by = "orig.ident") +
geom_hline(yintercept = 0.299, color= "red")
p6b <- p6b + ggtitle("Distribution of mito % by genotype") + xlab("Genotype") + ylab("count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
#grid.arrange(p1a,p2a, p3a, p1b, p2b, p3b, ncol=3)
p1a <- p1a + ylim(c(0,1500)) + ylab("Frequency of Counts") + theme(axis.text.x =  element_text(size=6)) + ggtitle("")
p2a <- p2a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
p3a <- p3a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) + xlab("fraction mt-")
p4a <- p4a + ylim(c(0,1500)) + ylab("Frequency of Counts") + ggtitle("")
p5a <- p5a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
p6a <- p6a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) + xlab("fraction mt-")
blank <- grid.rect(gp=gpar(col="white"))
byCellType <- byCellType + ggtitle(" ")
byGeno <- byGeno + ggtitle(" ")
neuronal_tsne <- neuronal_tsne + ggtitle(" ")
mito.plot <- mito.plot + ggtitle(" ") + ylab("Fraction of mt- genes in cell") #+ theme(axis.title.y = element_text(size=9))
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and filtering cut-offs for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.20,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and filtering cut-offs for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
min(experiment.aggregate@meta.data$nUMI)
p5a <- ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- neuronal cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=1700),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 1000, 1700, 3000)) + theme(axis.text.x = element_text(color=c("red","black", "red", "black")))
p5a
max(experiment.aggregate@meta.data$nGene)
ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- neuronal cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=1700),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 1000, 1700, 2500)) + theme(axis.text.x = element_text(color=c("red","black", "red", "black")))
p5a <- ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- neuronal cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=1700),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 1000, 1700, 2500)) + theme(axis.text.x = element_text(color=c("red","black", "red", "black")))
p5a <- p5a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and filtering cut-offs for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.20,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and filtering cut-offs for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - neuronal cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.2, 0.3)) + theme(axis.text.x = element_text(color=c(rep("black",2), "red")))
p6a <- ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - neuronal cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.2, 0.3)) + theme(axis.text.x = element_text(color=c(rep("black",2), "red")))
p6a <- p6a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) + xlab("fraction mt-")
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and filtering cut-offs for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.20,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and filtering cut-offs for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
pdf(file="QCMetrics.pdf", width = 13, height = 9)
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and filtering cut-offs for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.20,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and filtering cut-offs for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
dev.off()
pdf(file="QCMetrics.pdf", width = 13, height = 9)
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and thresholds for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.20,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and thresholds for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
dev.off()
load("unfiltered_expr_aggregate.Rdata")
p1a <- ggplot(experiment.aggregate@meta.data, aes(x=nUMI)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nUMI- all cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=10000),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500, 10000, 20000,30000,40000, 50000)) + theme(axis.text.x = element_text(color=c("red","red",rep("black",4))))
p1b <- VlnPlot(experiment.aggregate, "nUMI", do.return = TRUE) + geom_hline(yintercept = 10000, color= "red")
p1b <- p1b + ggtitle("Distribution of nUMI by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p2a <- ggplot(experiment.aggregate@meta.data, aes(x=nGene)) +
geom_histogram(binwidth=50, color="black", fill="white") + ggtitle("Distribution of nGene- all cells") +
geom_vline(aes(xintercept=500),color="red") + geom_vline(aes(xintercept=3000),color="red") + theme_bw() +
scale_x_continuous(breaks=c(500,3000,5000)) + theme(axis.text.x = element_text(color=c("red","red","black")))
p2b <- VlnPlot(experiment.aggregate, "nGene", do.return = TRUE) + geom_hline(yintercept = 3000, color= "red")
p2b <- p2b + ggtitle("Distribution of nGene by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
p3a <- ggplot(experiment.aggregate@meta.data, aes(x=percent.mito)) +
geom_histogram(binwidth=0.01, color="black", fill="white") + ggtitle("Distribution of mito % - all cells") +
geom_vline(aes(xintercept=0.3),color="red") + theme_bw() +
scale_x_continuous(breaks=c(0, 0.3, 0.50)) + theme(axis.text.x = element_text(color=c("black","red","black")))
p3b <- VlnPlot(experiment.aggregate, "percent.mito", do.return = TRUE) + geom_hline(yintercept = 0.3, color= "red")
p3b <- p3b + ggtitle("Distribution of mito % by genotype") + xlab("Genotype") + ylab("Count") + theme_bw() +
theme(plot.title = element_text(color="black", size=12),
axis.title.x = element_text(color="black", size=12),
axis.title.y = element_text(color="black", size=12),
legend.position = "none")
library(grid)
p1a <- p1a + ylim(c(0,1500)) + ylab("Frequency of Counts") + theme(axis.text.x =  element_text(size=6)) + ggtitle("")
p2a <- p2a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
p3a <- p3a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) + xlab("fraction mt-")
p4a <- p4a + ylim(c(0,1500)) + ylab("Frequency of Counts") + ggtitle("")
p5a <- p5a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
p6a <- p6a + ylim(c(0,1500)) + ylab(" ") + ggtitle(" ") + theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) + xlab("fraction mt-")
blank <- grid.rect(gp=gpar(col="white"))
byCellType <- byCellType + ggtitle(" ")
byGeno <- byGeno + ggtitle(" ")
neuronal_tsne <- neuronal_tsne + ggtitle(" ")
mito.plot <- mito.plot + ggtitle(" ") + ylab("Fraction of mt- genes in cell") #+ theme(axis.title.y = element_text(size=9))
setwd("/Users/AEveritt/projects/scRNAseq_L5_Tbr1/scRNAseq_L5_Tbr1_Rpackage/publication_images/")
pdf(file="QCMetrics.pdf", width = 13, height = 9)
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and thresholds for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.21,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and thresholds for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
dev.off()
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and thresholds for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.22,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and thresholds for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and thresholds for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.19,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and thresholds for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.24,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
pdf(file="QCMetrics.pdf", width = 13, height = 9)
plot_grid(blank,
plot_grid(cbind(ggplotGrob(p1a), ggplotGrob(p2a), ggplotGrob(p3a),  size = "last"),
byCellType, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("A) Distribution and thresholds for all cells",
"D) t-SNE all cells by cell type"),
label_x = c(-0.19,-0.15)),
blank,
plot_grid(mito.plot, byGeno, rel_widths = c(3/5, 2/5), labels=c("B) Mitochondrial Fraction in pilot and manuscript datasets",
"E) t-SNE all cells by genotype"),
label_x = c(-0.28,-0.15)),
blank,
plot_grid(cbind(ggplotGrob(p4a), ggplotGrob(p5a), ggplotGrob(p6a),  size = "last"),
neuronal_tsne, rel_widths = c(3/5, 2/5), nrow=1, ncol=2, labels=c("C) Distribution and thresholds for neuronal cells",
"F) t-NSE neuronal cells by genotype"),
label_x = c(-0.23,-0.196)),
nrow=6, ncol=1, rel_heights = c(1/21, 6/21, 1/21, 6/21, 1/21, 6/21) )
dev.off()
